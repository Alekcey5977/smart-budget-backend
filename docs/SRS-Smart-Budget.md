# Спецификация требований системы проекта “Smart Budget”

#### *Авторы: Килин Алексей, Лыков Дмитрий, Оськин Александр, Попов Вадим*

## Функциональные требования

### Регистрация пользователей.

- Регистрация с помощью email и пароля;

- Проверка уникальности email;

### Авторизация пользователей

- С помощью email и пароля.

### Редактирование профиля

- Редактирование персональных данных (имя, фамилия, отчество, email);

- Возможность изменить пароль;

- Добавление и редактирование реквизитов карты.

### Подключение банка к веб-приложению

- Автоматическое подключение к системе "*псевдо-банк*" при вводе реквизитов карты.

### Управление доходами

- Добавление доходов вручную;

- Автоматическое добавление доходов из "*псевдо-банка*". при условии подключенного банка;

- Редактирование записи о доходах;

- Удаление записи о даходах (только созданных вручную);

- Просмотр общей суммы доходов за выбранный период;

- Классификация по категориям (зарплата, перевод и т.д.).

### Управление расходами

- Добавление расходов вручную;

- Автоматическое добавление расходов из "*псевдо-банка*". при условии подключенного банка;

- Редактирование расходов;

- Удаление расходов (только созданных вручную);

- Классификация по категориям (продукты, развлечения и т.д.).

### Управление финансовыми целями

- Создание цели;

- Указание целевой суммы и дедлайна;

- Автоматический расчёт рекомендуемого взноса;

- Отображение прогресса выполнения цели;

- Уведомление при достижении 80% цели.

### Уведомления

- Создание уведомлений при превышении лимита или при выполнении (невыполнении) цели;

- Просмотр уведомлений в центре уведомлений веб-приложения.

### Панель пользователя (дашборд)

- Отображение графиков расходов и доходов по категориям;

- Общая сводка по балансу, дохода, расходам целям;

- Интерактивное обновление данных без перезагрузки страницы.

## Нефункциональные требования

- Устойчивость в нагрузке;

- Безопасность данных пользователей;

- Кроссплатформенность и совместимость;

- Логирование и мониторинг.

## Use Cases

### Регистрация пользователей

**Актор:** Новый пользователь.

**Предусловия:** Пользователь не зарегистрирован и находится на странице "*Регистрация*".

**Основной сценарий:**

1. Пользователь открывает веб-приложение и нажимает кнопку "*Регистрация*".

2. Система отображает форму с полями:
    - email;
    - пароль;
    - подтверждение пароля.

3. Пользователь вводит данные.

4. Система проверяет:
    - корректность email-формата;
    - совпадение паролей;
    - уникальность email.

5. Если email уже зарегистрирован — отображается сообщение: "*Пользователь с таким email уже существует*".

6. Если всё корректно — система: сохраняет нового пользователя.

7. Пользователя перенаправляет на главный экран с сообщением: "*Регистрация успешно завершена*".

**Постусловия:**

- Пользователь активирован в системе;

- Доступна авторизация.

### Авторизация пользователей

**Актор:** Зарегистрированный пользователь.

**Цель:** Пользователь входит в систему под своим email и паролем.

**Предусловия:** Пользователь уже зарегистрирован в системе.

**Основной сценарий:**

1. Пользователь нажимает кнопку "*Вход*".

2. Система отображает форму с полями: email и пароль.

3. Пользователь вводит данные и нажимает "*Войти*".

4. Система:

    - проверяет наличие пользователя;

    - сверяет пароль;

    - при успехе выдаёт JWT-токен доступа и refresh-токен.

5. Пользователь перенаправляется на главную страницу дашборда.

6. Если пароль неверный — система выводит сообщение: "*Неправильный логин или пароль*".

**Постусловия:**

- Пользователь входит в систему и имеет доступ к функционалу.

### Редактирование профиля

**Актор:** Авторизованный пользователь.

**Предусловия:** Пользователь находится на странице "*Профиль*".

**Цель:** Отредактировать персональные данные.

**Основной сценарий:**

1. Пользователь открывает раздел "*Профиль*".

2. В профиле отображаются текущие данные: имя, фамилия, отчество, email.

3. Пользователь нажимает кнопку "*Редактировать*".

4. Вводит новые значения (например, меняет фамилию или номер карты).

5. Система проверяет формат email.

6. Пользователь нажимает "*Сохранить*".

7. Система обновляет данные в БД и отображает сообщение: "*Изменения успешно сохранены*".

**Изменение пароля**

1. Пользователь в разделе профиля нажимает "Сменить пароль";

2. Вводит старый и новый пароль;

3. Система проверяет старый пароль, обновляет хэш и подтверждает успех.

**Постусловия:**

- Данные пользователя обновлены в базе данных;

- В системе зафиксировано изменение профиля;

- Новые данные отображаются во всех связанных модулях системы;

- Пользователь перенаправлен на страницу профиля с обновленными данными;

- В логах безопасности зафиксирована операция смены пароля.

### Привязать карту

**Актор:** Авторизованный пользователь.

**Предусловия:** Пользователь находится на главном экране.

**Цель:** Пользователь подключает карту (псевдо-банк) для автоматического импорта транзакций.

**Основной сценарий:**

1. Пользователь открывает раздел "*Мои банки*".

2. Нажимает кнопку "*Подключить карту*".

3. Вводит:

    - номер карты;

    - срок действия;

    - CVV.

4. Система обращается к Mock Bank API для проверки.

5. При успешной проверке создается связка с пользователем.

6. Система запускает задачу импорта транзакций.

7. Пользователь видит сообщение: "*Банк успешно подключен. Данные будут обновляться автоматически*".

**Постусловия:**

- Пользователь подключил новую карту;

- Данные о транзакциях будут обновляться автоматически.

### Отвязать карту

**Актор:** Авторизованный пользователь.

**Предусловия:** Пользователь находится на главном экране, у пользователя есть минимум одна подключенная карта в разделе "*Мои банки*".

**Цель:** Пользователь отвязывает карту (псевдо-банк).

**Основной сценарий:**

1. Пользователь открывает раздел "*Мои банки*".

2. Рядом с подключенной картой нажимает кнопку "Отвязать" (или иконку корзины).

3. Система открывает модальное окно с предупреждением:

    - текст: "*Вы уверены, что хотите отвязать карту .... 1234? Автоматический импорт будет остановлен. Импортированные ранее транзакции останутся (по умолчанию).*";

    - чекбокс: "*Удалить все транзакции, связанные с этой картой*" (по умолчанию — OFF);

    - поле для ввода пароля: "*Подтвердите действие, введите пароль*";

    - кнопки: "*Отвязать*" (красная) и "*Отмена*".

4. Пользователь отмечает/снимает чекбокс (если хочет удалить транзакции), вводит пароль и нажимает "**Отвязать**".

5. Показывается уведомление: "*Банк успешно отвязан*" и обновляет список банков.

6. Система отправляет email-подтверждение:

    - тема: "*Банк отвязан*";

    - тело: "*Вы отвязали карту ... 1234 в аккаунте example@mail.com. Если это были не вы — обратитесь в поддержку.*".

**Постусловия:**

- Пользователь отвязал карту.

### Управление доходами

**Актор:** Авторизованный пользователь.

**Предусловия:** Пользователь находится на странице "*Мои доходы*".

**Цель:** Пользователь добавляет, редактирует и просматривает доходы.

**Основной сценарий:**

- Добавление дохода вручную:

    1. Пользователь открывает раздел "*Доходы*".

    2. Нажимает "*Добавить доход*".

    3. Вводит данные:

        - сумма;

        - категория (зарплата, перевод и т.д.);

        - дата.

    4. Нажимает "*Сохранить*".

    5. Система сохраняет запись и обновляет дашборд.

    6. Пользователь может удалить доход, если он создан вручную.

- Автоматическое добавление дохода:

    1. При подключённом банке система получает транзакции.

    2. Транзакции автоматически попадают в раздел "*Доходы*".

    3. Пользователь может открыть запись и изменить категорию при необходимости.

- Просмотр доходов:

    - На странице "*Доходы*" отображается таблица с фильтрацией по дате и категории.

    - В верхней части — сумма всех доходов за выбранный период.

**Постусловия:**

- Новый доход успешно сохранён в системе и отображается в списке доходов;

- Дашборд обновлён: общая сумма доходов за период корректно пересчитана;

- При автоматическом импорте транзакций из "псевдо-банка" каждая запись о доходе сохранена без дублирования;

- Любые изменения категории дохода сохранены и учтены в аналитике и расчёте бюджета.

### Управление расходами

**Актор:** Авторизованный пользователь.

**Предусловия:** Пользователь находится на странице "*Мои расходы*".

**Цель:** Ведение и контроль расходов.

**Основной сценарий:**

- Добавление вручную:

    1. Пользователь открывает раздел "*Расходы*".

    2. Нажимает "*Добавить расход*".

    3. Вводит сумму, категорию из списка готовых категорий (продукты, транспорт, развлечения и т.д.), дату и комментарий.

    4. Нажимает "*Сохранить*".

    5. Система сохраняет запись и обновляет лимиты.

- Автоматический импорт:

    1. При подключённом банке система получает транзакции с отрицательной суммой.

    2. Классифицирует их по MCC-кодам.

    3. Добавляет их в список расходов.

- Редактирование и удаление:

    1. Пользователь может открыть транзакцию, изменить категорию.

    2. Пользователь может удалить только ту запись, которую создал самостоятельно.

    2. Система пересчитывает лимиты и обновляет графики в дашборде.

**Постусловия:**

- Новый расход успешно сохранён в системе и отображается в списке расходов;

- Лимиты по соответствующей категории расходов пересчитаны и обновлены в реальном времени;

- При автоматическом импорте транзакции из "*псевдо-банка*" каждая запись о расходе сохранена без дублирования;

- При изменении категории или удалении транзакции система корректно пересчитывает расходы по всем затронутым категориям;

- Дашборд обновлён в соответствии с внесёнными изменениями.

### Управление финансовыми целями

**Актор:** Авторизованный пользователь.

**Предусловия:** Пользователь находится на главном экране.

**Цель:** Пользователь создаёт и отслеживает цели накопления.

**Основной сценарий:**

- Создание цели:

    1. Пользователь открывает раздел "*Цели*".

    2. Нажимает "*Создать цель*".

    3. Заполняет поля:

        - название цели;

        - целевая сумма;

        - дедлайн;

        - текущие накопления (опционально).

    4. Система рассчитывает рекомендуемый ежемесячный взнос.

    5. Пользователь сохраняет цель, и она появляется в списке с прогресс-баром.

    6. Пользователь может вручную добавить взнос (N рублей) на определенную цель.

- Отслеживание:

    1. На странице цели отображается прогресс (% выполнено).

    2. При достижении 80% система формирует уведомление: "*Цель 'Новый ноутбук' достигнута на 80%*".

**Постусловия:** 

- Пользователь создал новую цель;

- Пользователь видит прогресс по созданной цели.

- У пользователя есть возможность добавить взнос (N рублей) на цель.

### Уведомления

**Актор:** Зарегистрированный, либо авторизованный пользователь.

**Предусловия:** Произошел один или несколько сценариев.

**Цель:** Пользователь получает системные уведомления.

**Основной сценарий:**

1. При превышении лимита или достижении цели система создаёт запись в таблице уведомлений.

2. На фронтенде в правом верхнем углу загорается иконка уведомления (колокольчик).

3. Пользователь кликает на иконку и открывает "*Центр уведомлений*".

4. В списке отображаются:

    - тип (инфо, предупреждение, цель);

    - дата;

    - текст уведомления.

5. Уведомление можно отметить как "*прочитанное*".

**Постусловия:**

- Уведомление создано и сохранено в системе;

- Иконка уведомлений отображает наличие непрочитанных сообщений;

- Пользователь может просмотреть, прочитать и перейти по уведомлению;

- Статус уведомления обновляется на "*прочитано*", если пользователь нажал на само уведомление и прочитал его, если же он просто увидел уведомление в списке уведомлений, то оно не будет отображаться "*прочитанным*".

### Панель пользователя (дашборд)

**Актор:** Авторизованный пользователь.

**Предусловия:** Пользователь находится на главном экране.

**Цель:** Предоставить пользователю визуальное представление бюджета.

**Основной сценарий:**

1. После входа система открывает "*Дашборд*".

2. Отображается:

    - баланс;

    - график расходов по категориям;

    - статус целей и лимитов;

    - последние транзакции.

3. Пользователь может:

    - выбрать период (неделя, месяц, год);

    - перейти к разделу "*Расходы*", "*Доходы*" или "*Цели*".

4. Все данные обновляются динамически без перезагрузки.

**Постусловия:**

- Дашборд отображает актуальные данные по балансу, расходам, целям и лимитам;

- Выбранный период корректно применяется ко всем виджетам;

- Все элементы интерфейса обновляются динамически при изменении данных или периода;

- Переходы в другие разделы работают корректно и сохраняют контекст пользователя.