# Спецификация требований системы проекта “Smart Budget”

#### *Авторы: Килин Алексей, Лыков Дмитрий, Оськин Александр, Попов Вадим*

## Функциональные требования

### Регистрация пользователей.

- Регистрация с помощью email, пароля, фамилии, имени;

- Отчество доступно не обязательно при регистрации;

- Проверка уникальности email.

### Авторизация пользователей

- С помощью email и пароля.

### Редактирование профиля

- Редактирование персональных данных (имя, фамилия, отчество);

- Возможность изменить пароль;

- Добавление и редактирование реквизитов карты.

### Подключение банка к веб-приложению 

- Автоматическое подключение к системе "*псевдо-банк*" при вводе реквизитов карты.

### Управление доходами

- Автоматическое добавление доходов из "*псевдо-банка*", при условии подключенного банка;

- Редактирование категории у доходов;

- Просмотр общей суммы доходов за выбранный период;

- Классификация по категориям (зарплата, перевод и т.д.).

### Управление расходами

- Автоматическое добавление расходов из "*псевдо-банка*", при условии подключенного банка;

- Редактирование категории у расходов;

- Классификация по категориям (продукты, развлечения и т.д.).

### Управление финансовыми целями

- Создание цели;

- Указание целевой суммы и дедлайна;

- Автоматический расчёт рекомендуемого взноса;

- Отображение прогресса выполнения цели;

- Уведомление при достижении 80% цели.

### Уведомления

- Создание уведомлений выполнении (невыполнении) цели;

- Просмотр уведомлений в центре уведомлений веб-приложения.

### Панель пользователя (дашборд)

- Отображение графиков расходов и доходов по категориям;

- Общая сводка по балансу, дохода, расходам целям;

- Интерактивное обновление данных без перезагрузки страницы.

## Нефункциональные требования

- Устойчивость в нагрузке;

- Безопасность данных пользователей;

- Кроссплатформенность и совместимость;

## Use Cases

### Регистрация пользователей

**Актор:** Новый пользователь.

**Предусловия:** Пользователь не зарегистрирован и находится на странице "*Регистрация*".

**Основной сценарий:**

1. Пользователь открывает веб-приложение и нажимает кнопку "*Регистрация*".

2. Система отображает форму с полями:
    - email;
    - пароль;
    - подтверждение пароля.

3. Пользователь вводит данные.

4. Система проверяет:
    - корректность email-формата;
    - совпадение паролей;
    - уникальность email.

5. Если email уже зарегистрирован - отображается сообщение: "*Пользователь с таким email уже существует*".

6. Если всё корректно - открывается еще одна страница регистрации.

7. Система отображает форму с полями:
    - Фамилия;
    - Имя;
    - Отчество. 

8. Пользователь вводит данные.

9. Если всё корректно (обязательно введены имя, фамилия, а отчество - не обязательно) - система: сохраняет нового пользователя.

10. Пользователя перенаправляет на дашборд.

**Постусловия:**

- Пользователь активирован в системе;

- Доступна авторизация.

### Авторизация пользователей

**Актор:** Зарегистрированный пользователь.

**Цель:** Пользователь входит в систему под своим email и паролем.

**Предусловия:** Пользователь уже зарегистрирован в системе.

**Основной сценарий:**

1. Пользователь нажимает кнопку "*Вход*".

2. Система отображает форму с полями: email и пароль.

3. Пользователь вводит данные и нажимает "*Войти*".

4. Система:

    - проверяет наличие пользователя;

    - сверяет пароль;

    - при успехе выдаёт JWT-токен доступа и refresh-токен.

5. Пользователь перенаправляется на главную страницу дашборда.

6. Если пароль неверный - система выводит сообщение: "*Неправильный логин или пароль*".

**Постусловия:**

- Пользователь входит в систему и имеет доступ к функционалу.

### Редактирование профиля

**Актор:** Авторизованный пользователь.

**Предусловия:** Пользователь находится на странице "*Профиль*".

**Цель:** Отредактировать персональные данные.

**Основной сценарий:**

1. Пользователь открывает раздел "*Профиль*".

2. В профиле отображаются текущие данные: имя, фамилия, отчество, email, аватарка.

3. Вводит новые значения (имя, фамилия, отчетсво).

4. Email - не можем менять. 

5. Пользователь нажимает "*Сохранить*".

6. Также пользователь может изменить аватарку из предзагруженного списка изображений. 

7. Система обновляет данные в БД и отображает сообщение: "*Изменения успешно сохранены*".

**Постусловия:**

- Данные пользователя обновлены в базе данных;

- В системе зафиксировано изменение профиля;

- Новые данные отображаются во всех связанных модулях системы;

- Пользователь перенаправлен на страницу профиля с обновленными данными;

### Привязать карту

**Актор:** Авторизованный пользователь.

**Предусловия:** Пользователь находится на главном экране.

**Цель:** Пользователь подключает карту (псевдо-банк) для автоматического импорта транзакций.

**Основной сценарий:**

1. Пользователь открывает раздел "*Мои банки*".

2. Нажимает кнопку "*Подключить карту*".

3. Вводит:

    - номер карты;

    - срок действия;

    - CVV.

4. Система обращается к Mock Bank API для проверки.

5. При успешной проверке создается связка с пользователем.

6. Система запускает задачу импорта транзакций.

7. Пользователь видит сообщение: "*Банк успешно подключен. Данные будут обновляться автоматически*".

**Постусловия:**

- Пользователь подключил новую карту;

- Данные о транзакциях будут обновляться автоматически.

### Отвязать карту

**Актор:** Авторизованный пользователь.

**Предусловия:** Пользователь находится на главном экране, у пользователя есть минимум одна подключенная карта в разделе "*Мои банки*".

**Цель:** Пользователь отвязывает карту (псевдо-банк).

**Основной сценарий:**

1. Пользователь открывает раздел "*Мои банки*".

2. Рядом с подключенной картой нажимает кнопку "Отвязать" (или иконку корзины).

3. Система открывает модальное окно с предупреждением:

    - текст: "*Вы уверены, что хотите отвязать карту .... 1234? Автоматический импорт будет остановлен. Импортированные ранее транзакции останутся (по умолчанию).*";

    - чекбокс: "*Удалить все транзакции, связанные с этой картой*" (по умолчанию - OFF);

    - поле для ввода пароля: "*Подтвердите действие, введите пароль*";

    - кнопки: "*Отвязать*" (красная) и "*Отмена*".

4. Пользователь отмечает/снимает чекбокс (если хочет удалить транзакции), вводит пароль и нажимает "**Отвязать**".

5. Показывается уведомление: "*Банк успешно отвязан*" и обновляет список банков.

6. Система отправляет email-подтверждение:

    - тема: "*Банк отвязан*";

    - тело: "*Вы отвязали карту ... 1234 в аккаунте example@mail.com. Если это были не вы - обратитесь в поддержку.*".

**Постусловия:**

- Пользователь отвязал карту. -->

### Управление доходами

**Актор:** Авторизованный пользователь.

**Предусловия:** Пользователь находится на странице "*История операций*".

**Цель:** Пользователь добавляет, редактирует и просматривает доходы.

**Основной сценарий:**

- Автоматическое добавление дохода:

    1. При подключённом банке система получает транзакции.

    2. Транзакции автоматически попадают в раздел "*История операций*".
    
    3. Пользователь может открыть запись и изменить категорию при необходимости.

- Просмотр доходов:

    - На странице "*История операций*" отображается таблица с фильтрацией по дате и категории.
    
    - Пользователь может использовать фильтрацию по дате, сумме транзакции, категории.  

    - В верхней части - сумма всех доходов и расходов.

**Постусловия:**

- Дашборд обновлён: общая сумма доходов за период корректно пересчитана;

- При автоматическом импорте транзакций из "псевдо-банка" каждая запись о доходе сохранена без дублирования;

### Управление расходами

**Актор:** Авторизованный пользователь.

**Предусловия:** Пользователь находится на странице "*История операций*".

**Цель:** Ведение и контроль расходов.

**Основной сценарий:**

- Автоматический добавление расходов:

    1. При подключённом банке система получает транзакции с отрицательной суммой.

    2. Классифицирует их по MCC-кодам.

    3. Добавляет их в список расходов.
    
    4. Пользователь может открыть запись и изменить категорию при необходимости.

**Постусловия:**

- Дашборд обновлён: общая сумма расходов за период корректно пересчитана;

- При автоматическом импорте транзакций из "псевдо-банка" каждая запись о доходе сохранена без дублирования;

### Управление финансовыми целями

**Актор:** Авторизованный пользователь.

**Предусловия:** Пользователь находится на дашборде.

**Цель:** Пользователь создаёт и отслеживает цели накопления.

**Основной сценарий:**

- Создание цели:

    1. Пользователь открывает раздел "*Цели*".

    2. Нажимает "*Создать цель*".

    3. Заполняет поля:

        - название цели;

        - целевая сумма;

        - дедлайн.
  
    <!-- 4. Система рассчитывает рекомендуемый ежемесячный взнос. -->

    4. Пользователь сохраняет цель, и она появляется в списке с прогресс-баром.

    5. Пользователь может вручную добавить взнос (N рублей) на определенную цель.

- Отслеживание:

    1. На странице цели отображается прогресс (% выполнено).

    2. При достижении 80% система формирует уведомление: "*Цель 'Новый ноутбук' достигнута на 80%*".

**Постусловия:** 

- Пользователь создал новую цель;

- Пользователь видит прогресс по созданной цели.

- У пользователя есть возможность добавить взнос (N рублей) на цель.

### Уведомления

**Актор:** Зарегистрированный, либо авторизованный пользователь.

**Предусловия:** Произошел один или несколько сценариев.

**Цель:** Пользователь получает системные уведомления.

**Основной сценарий:**

1. При достижении цели система создаёт запись в таблице уведомлений.

2. На фронтенде в правом верхнем углу загорается иконка уведомления (колокольчик).

3. Пользователь кликает на иконку и открывает "*Центр уведомлений*".

4. В списке отображаются:

    - тип (инфо, предупреждение, цель);

    - дата;

    - текст уведомления.

5.  Все уведомления можно отметить как "*прочитанное*" нажав галочку в вверхнем правом углу.

**Постусловия:**

- Уведомление создано и сохранено в системе;

- Иконка уведомлений отображает наличие непрочитанных сообщений;

- Пользователь может просмотреть, прочитать и перейти по уведомлению;

- Уведомления отметились как "*прочитанное*".

### Панель пользователя (дашборд)

**Актор:** Авторизованный пользователь.

**Предусловия:** Пользователь находится на главном экране.

**Цель:** Предоставить пользователю визуальное представление бюджета.

**Основной сценарий:**

1. После входа система открывает "*Дашборд*".

2. Отображается:

    - баланс;

    - график расходов по категориям;

    - статус целей и лимитов;

    - последние транзакции.

3. Пользователь может:

    - перейти к разделу "*История операций*";
    - перейти к разделу "*Цели*";
    - перейти к разделу "*Уведомления*".
    - перейти к разделу "*Прифиль*".
    - посмотреть последние транзакции.

4. Все данные обновляются динамически без перезагрузки.

**Постусловия:**

- Дашборд отображает актуальные данные по балансу, расходам, целям и лимитам;

- Переходы в другие разделы работают корректно и сохраняют контекст пользователя.